{% extends 'base.html' %}

{% load crispy_forms_filters %}
{% load static %}


{% block style %}
<link rel="stylesheet" href="{% static 'photos/comments.css' %}">
{% endblock  %}

{% block main %}
<div class="container-fluid col-lg-4 col-md-12 mb-4 mb-lg-0">
	<p class='posted-by'>Posted By: {{photo.posted_by}}</p>
	<div class="card">
		<img src="{{photo.image.url}}" class="card-img-top" alt="...">
		<div class="card-body">

			{% for message in messages  %}
			<div class="alert alert-danger alert-dismissible fade show" role="alert">
				{{message}}
				<button type="button" class="btn-close" data-dismiss="alert" aria-label="Close">
					<span aria-hidden="true"></span>
				</button>
			</div>
			{% endfor %}

			{% if comments %}

			{% for comment in comments %}

			<div class='mb-3'>
				<small style='whitespace:no-wrap;'>{{comment.posted_at|date:"M d h:i a"}} - From
					{{comment.user}}</small>
				<p style='margin:0;'>{{comment.content}}</p>
{#				<a href="{% url 'comment like' comment.id %}" class='pe-1'>#}
{#					<i class="fas fa-thumbs-up"></a></i>{{comment.commentlike_set.count}}#}
{##}
{#				<a href="{% url 'comment dislike' comment.id %}" class='pe-1'>#}
{#					<i class="fas fa-thumbs-down"></a></i>{{comment.commentdislike_set.count}}#}

				{% comment %} checks if the logged user is the one who is the owner of the comment {% endcomment %}
				{% if request.user == comment.user %}
				<a class='edit' href="{% url 'delete comment' comment.id %}">Delete</a>
				<a class='edit' href="{% url 'edit comment' comment.id %}">Edit</a>
				{% endif %}
			</div>

			{% endfor %}
			{% else %}
			<p>There are no comments for this picture</p>
			{% endif %}
		</div>

		{% if request.user.is_authenticated %}
		<div class="card-body">
			<form action="{% url 'add comment' photo.id %}" method="POST">
				<div class="form-group">
					{% csrf_token %}
					{{ form|crispy }}
				</div>
				<button class='btn btn-outline-dark mt-3' type="submit">Post</button>
			</form>
		</div>
	</div>
	{%endif%}
</div>

{% endblock %}

{% block scripts %}

{% endblock  %}